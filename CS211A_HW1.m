%% CS211A Visual Computing Assignment 1
% Written by Qiaoqian Hu, Daniel Cheng, Allen Zhao
% Written date: January 20th, 2018

steps = [1 3 4];
img1 = im2double(imread('img\CARTOON.jpg'));
img2 = im2double(imread('img\flowergray.jpg'));
img3 = im2double(imread('img\kitty.jpg'));
img4 = im2double(imread('img\polarcities.jpg'));
img5 = im2double(imread('img\text.jpg'));

%% Part0
if ismember(0, steps(:))
    part0();
end

%% Part1
if ismember(1, steps(:))
    save_images = 0;
    box_filter=[1/4,1/4;1/4,1/4];
    [img1_gauss0, img1_gauss1, img1_gauss2, img1_gauss3, img1_gauss4, img1_gauss5,...
        img1_gauss6, img1_gauss7, img1_gauss8] = part1(img1, box_filter, 'img1', save_images);
    [img2_gauss0, img2_gauss1, img2_gauss2, img2_gauss3, img2_gauss4, img2_gauss5,...
        img2_gauss6, img2_gauss7, img2_gauss8] = part1(img2, box_filter, 'img2', save_images);
    [img3_gauss0, img3_gauss1, img3_gauss2, img3_gauss3, img3_gauss4, img3_gauss5,...
        img3_gauss6, img3_gauss7, img3_gauss8] = part1(img3, box_filter, 'img3', save_images);
    [img4_gauss0, img4_gauss1, img4_gauss2, img4_gauss3, img4_gauss4, img4_gauss5,...
        img4_gauss6, img4_gauss7, img4_gauss8] = part1(img4, box_filter, 'img4', save_images);
    [img5_gauss0, img5_gauss1, img5_gauss2, img5_gauss3, img5_gauss4, img5_gauss5,...
        img5_gauss6, img5_gauss7, img5_gauss8] = part1(img5, box_filter, 'img5', save_images);
end

%% Part2
if ismember(2, steps(:))
    save_images = 1;
    [img1_lap0, img1_lap1, img1_lap2, img1_lap3, img1_lap4, img1_lap5, img1_lap6, img1_lap7] = ...
        part2(img1_gauss0, img1_gauss1, img1_gauss2, img1_gauss3, img1_gauss4, ...
        img1_gauss5, img1_gauss6, img1_gauss7, img1_gauss8, 'img1', save_images);
    [img2_lap0, img2_lap1, img2_lap2, img2_lap3, img2_lap4, img2_lap5, img2_lap6, img2_lap7] = ...
        part2(img2_gauss0, img2_gauss1, img2_gauss2, img2_gauss3, img2_gauss4, ...
        img2_gauss5, img2_gauss6, img2_gauss7, img2_gauss8, 'img2', save_images);
    [img3_lap0, img3_lap1, img3_lap2, img3_lap3, img3_lap4, img3_lap5, img3_lap6, img3_lap7] = ...
        part2(img3_gauss0, img3_gauss1, img3_gauss2, img3_gauss3, img3_gauss4, ...
        img3_gauss5, img3_gauss6, img3_gauss7, img3_gauss8, 'img3', save_images);
    [img4_lap0, img4_lap1, img4_lap2, img4_lap3, img4_lap4, img4_lap5, img4_lap6, img4_lap7] = ...
        part2(img4_gauss0, img4_gauss1, img4_gauss2, img4_gauss3, img4_gauss4, ...
        img4_gauss5, img4_gauss6, img4_gauss7, img4_gauss8, 'img4', save_images);
    [img5_lap0, img5_lap1, img5_lap2, img5_lap3, img5_lap4, img5_lap5, img5_lap6, img5_lap7] = ...
        part2(img5_gauss0, img5_gauss1, img5_gauss2, img5_gauss3, img5_gauss4, ...
        img5_gauss5, img5_gauss6, img5_gauss7, img5_gauss8, 'img5', save_images);
end

%% Part3
if ismember(3, steps(:))
    %Step 1 - Generate filter and convolve with existing Gaussian pyramid
    save_images = 1;
    threshold_variance=0.03 ;
    [img1_edge0, img1_edge1, img1_edge2, img1_edge3, img1_edge4, img1_edge5, img1_edge6, img1_edge7, img1_edge8] = ...
        part3(img1_gauss0, img1_gauss1, img1_gauss2, img1_gauss3, img1_gauss4, ...
        img1_gauss5, img1_gauss6, img1_gauss7, img1_gauss8, threshold_variance, 'img1', save_images);
    [img2_edge0, img2_edge1, img2_edge2, img2_edge3, img2_edge4, img2_edge5, img2_edge6, img2_edge7, img2_edge8] = ...
        part3(img2_gauss0, img2_gauss1, img2_gauss2, img2_gauss3, img2_gauss4, ...
        img2_gauss5, img2_gauss6, img2_gauss7, img2_gauss8, threshold_variance, 'img2', save_images);
    [img3_edge0, img3_edge1, img3_edge2, img3_edge3, img3_edge4, img3_edge5, img3_edge6, img3_edge7, img3_edge8] = ...
        part3(img3_gauss0, img3_gauss1, img3_gauss2, img3_gauss3, img3_gauss4, ...
        img3_gauss5, img3_gauss6, img3_gauss7, img3_gauss8, threshold_variance, 'img3', save_images);
    [img4_edge0, img4_edge1, img4_edge2, img4_edge3, img4_edge4, img4_edge5, img4_edge6, img4_edge7, img4_edge8] = ...
        part3(img4_gauss0, img4_gauss1, img4_gauss2, img4_gauss3, img4_gauss4, ...
        img4_gauss5, img4_gauss6, img4_gauss7, img4_gauss8, threshold_variance, 'img4', save_images);
    [img5_edge0, img5_edge1, img5_edge2, img5_edge3, img5_edge4, img5_edge5, img5_edge6, img5_edge7, img5_edge8] = ...
        part3(img5_gauss0, img5_gauss1, img5_gauss2, img5_gauss3, img5_gauss4, ...
        img5_gauss5, img5_gauss6, img5_gauss7, img5_gauss8, threshold_variance, 'img5', save_images);
end

%% Part4
if ismember(4, steps(:))
    save_images = 0;
    %part4(img1, img2, 'img/hw1/blended/pair1_', save_images);
    %part4(img1, img3, 'img/hw1/blended/pair2_', save_images);
    part4(img4, img5, 'img/hw1/blended/pair3_', save_images);
end
